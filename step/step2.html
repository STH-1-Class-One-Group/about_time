<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>Step 2 â€” CallStack vs Task Queue</title>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=IBM+Plex+Mono:wght@400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #0d0d1a; --surface: #13132b; --border: #2a2a4a;
            --text: #e8e8ff; --muted: #6666aa;
            --pika: #f1c40f; --squirt: #3498db;
        }
        *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: 'IBM Plex Mono', monospace; background: var(--bg); color: var(--text); padding: 40px 20px; }

        h1 { font-family: 'Press Start 2P', monospace; font-size: 0.9rem; color: var(--squirt); text-align: center; margin-bottom: 8px; line-height: 1.8; }
        .subtitle { text-align: center; color: var(--muted); font-size: 0.7rem; margin-bottom: 32px; }

        .race-track { display: flex; gap: 20px; max-width: 860px; margin: 0 auto 24px; flex-wrap: wrap; }
        .panel { flex: 1 1 340px; background: var(--surface); border: 1px solid var(--border); border-radius: 12px; padding: 24px; }
        .panel.taskqueue { background: rgba(52,152,219,0.06); border-color: rgba(52,152,219,0.25); }
        .panel h2 { font-family: 'Press Start 2P', monospace; font-size: 0.55rem; text-align: center; margin-bottom: 16px; line-height: 1.8; padding-bottom: 12px; border-bottom: 1px solid var(--border); }

        .card { border: 1px solid var(--border); border-radius: 8px; padding: 12px 16px; margin-bottom: 10px; background: rgba(255,255,255,0.03); animation: popIn 0.2s ease; }
        .card p { font-size: 0.75rem; margin: 2px 0; }
        @keyframes popIn { from { opacity:0; transform:translateY(6px); } to { opacity:1; transform:translateY(0); } }

        .timer { font-size: 0.7rem; text-align: center; margin-bottom: 12px; font-weight: 600; }

        .btn-row { display: flex; justify-content: center; margin-bottom: 32px; }
        button { font-family: 'Press Start 2P', monospace; font-size: 0.6rem; padding: 14px 28px; background: var(--squirt); color: #000; border: none; border-radius: 4px; cursor: pointer; box-shadow: 0 4px 0 #1a6fa8; }
        button:active { transform: translateY(2px); }

        .console-tip { text-align: center; font-size: 0.65rem; color: var(--muted); margin-bottom: 24px; }
        .console-tip code { color: var(--squirt); }

        .explain { background: rgba(52,152,219,0.06); border: 1px solid rgba(52,152,219,0.2); border-radius: 8px; padding: 16px; max-width: 860px; margin: 0 auto; font-size: 0.68rem; line-height: 1.9; color: var(--muted); }
        .explain strong { color: var(--text); }

        .arrow { text-align: center; font-size: 0.7rem; color: var(--muted); margin: 8px 0; }
    </style>
</head>
<body>

    <h1>Step 2</h1>
    <h1 style="margin-top:4px; color:var(--squirt);">CallStack vs Task Queue</h1>
    <p class="subtitle">í”¼ì¹´ì¸„(ë™ê¸°) vs ê¼¬ë¶€ê¸°(setTimeout 0ms)</p>
    <p class="console-tip">ğŸ’¡ <code>F12 â†’ Console</code> ì„ ì—´ì–´ë‘ì„¸ìš”</p>

    <div class="btn-row">
        <button id="start-btn">ğŸ START</button>
    </div>

    <div class="race-track">
        <div class="panel">
            <h2 style="color:var(--pika);">â‘  Pikachu Family ğŸŸ¡<br>CallStack (ë™ê¸°)</h2>
            <div id="sync-timer" class="timer" style="color:var(--pika);">Ready...</div>
            <div id="sync-container"></div>
        </div>

        <div class="panel taskqueue">
            <h2 style="color:var(--squirt);">â‘¡ Squirtle Family ğŸ”µ<br>Task Queue (setTimeout 0ms)</h2>
            <div id="squirtle-timer" class="timer" style="color:var(--squirt);">Ready...</div>
            <div id="squirtle-container"></div>
        </div>
    </div>

    <div class="explain">
        <strong>í•µì‹¬ ê´€ì°° í¬ì¸íŠ¸</strong><br><br>
        ì½˜ì†”ì„ ë³´ë©´ â‘  í”¼ì¹´ ë“±ë¡/ì‹¤í–‰ì´ ëª¨ë‘ ì°íŒ ë’¤<br>
        â‘¡ ê¼¬ë¶€ê¸° <strong>ë“±ë¡</strong> ë¡œê·¸ê°€ ì°íˆê³ ,<br>
        ê·¸ ë‹¤ìŒì—ì•¼ ê¼¬ë¶€ê¸° <strong>ì‹¤í–‰</strong> ë¡œê·¸ê°€ ì°í™ë‹ˆë‹¤.<br><br>
        <strong>setTimeout 0ms</strong> ë¼ë„ ì½œë°±ì€ ì¦‰ì‹œ ì‹¤í–‰ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.<br>
        Web API â†’ Task Queue â†’ ì½œìŠ¤íƒì´ ë¹ˆ í›„ì—ì•¼ ì²˜ë¦¬ë©ë‹ˆë‹¤.
    </div>

    <script>
        const raceStart = { time: 0 };

        function log(section, message) {
            const elapsed = ((performance.now() - raceStart.time) / 1000).toFixed(3);
            console.log(`[${elapsed}s] %c${section}%c ${message}`,
                'font-weight:bold; color:#aaffaa;', 'font-weight:normal;');
        }

        function renderCard(containerId, name, label, color) {
            const elapsed = ((performance.now() - raceStart.time) / 1000).toFixed(3);
            const card = document.createElement('div');
            card.className = 'card';
            card.innerHTML = `
                <p><strong style="color:${color};">${name}</strong></p>
                <p style="color:${color}; font-size:0.6rem;">${label}</p>
                <p style="color:var(--muted); font-size:0.55rem;">+${elapsed}s</p>
            `;
            document.getElementById(containerId).appendChild(card);
        }

        // â‘  í”¼ì¹´ì¸„ â€” ì™„ì „ ë™ê¸°
        function runPikaSection() {
            document.getElementById('sync-container').innerHTML = '';
            document.getElementById('sync-timer').innerText = 'Running...';
            log('â‘  PIKA  ', 'â–¶ ì‹œì‘ â€” CallStack ë¸”ë¡œí‚¹ ì‹œì‘');

            for (const name of ['í”¼ì¸„', 'í”¼ì¹´ì¸„', 'ë¼ì´ì¸„']) {
                log('â‘  PIKA  ', `  ì½œìŠ¤íƒ ì‹¤í–‰ â†’ ${name}`);
                renderCard('sync-container', name, 'CallStack (ë™ê¸°)', 'var(--pika)');
            }

            log('â‘  PIKA  ', 'â–  ì™„ë£Œ');
            document.getElementById('sync-timer').innerText = 'âœ… ì™„ë£Œ';
        }

        // â‘¡ ê¼¬ë¶€ê¸° â€” Task Queue (setTimeout 0ms)
        function runSquirtleSection() {
            document.getElementById('squirtle-container').innerHTML = '';
            document.getElementById('squirtle-timer').innerText = 'Running...';
            log('â‘¡ SQUIRT', 'â–¶ ì‹œì‘ â€” setTimeout 0ms ë“±ë¡ ì‹œì‘');

            ['ê¼¬ë¶€ê¸°', 'ì–´ë‹ˆë¶€ê¸°', 'ê±°ë¶ì™•'].forEach((name, i) => {
                setTimeout(() => {
                    // ì½œìŠ¤íƒì´ ì™„ì „íˆ ë¹ˆ í›„ ì—¬ê¸° ì‹¤í–‰ë¨
                    log('â‘¡ SQUIRT', `  âœ… Task Queue â†’ ì½œìŠ¤íƒ â†’ ì‹¤í–‰: ${name}`);
                    renderCard('squirtle-container', name, 'Task Queue (setTimeout 0ms)', 'var(--squirt)');
                    if (i === 2) document.getElementById('squirtle-timer').innerText = 'âœ… ì™„ë£Œ';
                }, 0);

                log('â‘¡ SQUIRT', `  ë“±ë¡ë§Œ ì™„ë£Œ (${name}) â†’ Task Queue ëŒ€ê¸° ì¤‘`);
            });

            log('â‘¡ SQUIRT', 'â–  ë“±ë¡ ë â†’ ì¦‰ì‹œ ë°˜í™˜ (ì½œë°±ì€ ì•„ì§ ì‹¤í–‰ ì•ˆ ë¨)');
        }

        document.getElementById('start-btn').addEventListener('click', () => {
            raceStart.time = performance.now();
            console.clear();
            console.log('%c=== Step 2: CallStack vs Task Queue ===', 'font-size:1rem; font-weight:bold; color:#3498db;');
            console.log('%cê¼¬ë¶€ê¸°ëŠ” 0ms ë”œë ˆì´ì—¬ë„ í”¼ì¹´ì¸„ê°€ ì™„ì „íˆ ëë‚œ ë’¤ì— ì²˜ë¦¬ë©ë‹ˆë‹¤.', 'color:#888;');
            console.log('');

            runPikaSection();    // â‘  ë™ê¸° â€” ë¸”ë¡œí‚¹
            runSquirtleSection(); // â‘¡ ë“±ë¡ë§Œ í•˜ê³  ì¦‰ì‹œ ë°˜í™˜
            // ì½œìŠ¤íƒ ë¹„ì›Œì§ â†’ Task Queueì—ì„œ ê¼¬ë¶€ê¸° ì½œë°± í•˜ë‚˜ì”© êº¼ëƒ„
        });
    </script>
</body>
</html>